

============================== 2025-05-14 05:39:51.620624 | fb731e08-933f-4917-b928-420f4f857230 ==============================
[0m05:39:51.620624 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:39:51.622387 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:39:51.622650 [debug] [MainThread]: Tracking: tracking
[0m05:39:51.643720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7214b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m05:39:51.655244 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:39:51.656201 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:39:51.656550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fb731e08-933f-4917-b928-420f4f857230', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723700>]}
[0m05:39:51.664783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb705ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb720d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721b70>]}
[0m05:39:51.665153 [debug] [MainThread]: Flushing usage events
[0m05:39:52.867895 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading custom_postgres: example/schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version:2
    2  | 
    3  | models:
    4  |   - name: films
    5  |     description: "Films table"
    6  |     columns:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 7


============================== 2025-05-14 05:42:38.756247 | c9f3bb32-02e5-4a7f-b37a-f72135016056 ==============================
[0m05:42:38.756247 [info ] [MainThread]: Running with dbt=1.4.7
[0m05:42:38.759626 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m05:42:38.759908 [debug] [MainThread]: Tracking: tracking
[0m05:42:38.781030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7214b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m05:42:38.794216 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m05:42:38.795285 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m05:42:38.795774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9f3bb32-02e5-4a7f-b37a-f72135016056', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723700>]}
[0m05:42:38.806103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb705b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7238b0>]}
[0m05:42:38.806532 [debug] [MainThread]: Flushing usage events
[0m05:42:40.098114 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading custom_postgres: example/source.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version:2
    2  | 
    3  | sources:
    4  |   - name: destination_db
    5  |     description: "raw data from the destination database"
    6  |     database: destination_db
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8


============================== 2025-05-14 06:12:50.770417 | 7d11ff81-0852-4632-a1c2-364a3e523a39 ==============================
[0m06:12:50.770417 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:12:50.772255 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:12:50.776154 [debug] [MainThread]: Tracking: tracking
[0m06:12:50.794884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7214b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m06:12:50.809004 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:12:50.809947 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:12:50.810360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7d11ff81-0852-4632-a1c2-364a3e523a39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7234f0>]}
[0m06:12:50.818749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb707880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7238b0>]}
[0m06:12:50.819118 [debug] [MainThread]: Flushing usage events
[0m06:12:52.071348 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading custom_postgres: example/source.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version:2
    2  | 
    3  | sources:
    4  |   - name: destination_db
    5  |     description: "Raw data from the destination database"
    6  |     database: destination_db
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8


============================== 2025-05-14 06:13:46.249177 | f10beaaf-c648-425c-af11-5897ad0a5c4d ==============================
[0m06:13:46.249177 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:13:46.251028 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:13:46.251462 [debug] [MainThread]: Tracking: tracking
[0m06:13:46.269665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7214b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m06:13:46.282430 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:13:46.283432 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m06:13:46.283819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb720430>]}
[0m06:13:46.767371 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m06:13:46.777491 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m06:13:46.779884 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m06:13:46.786096 [debug] [MainThread]: 1699: static parser successfully parsed example/films_rating.sql
[0m06:13:46.837385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e78730>]}
[0m06:13:46.845298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e40e50>]}
[0m06:13:46.845741 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:13:46.846130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd2784c0>]}
[0m06:13:46.847652 [info ] [MainThread]: 
[0m06:13:46.849591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:13:46.851553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:13:46.860503 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:13:46.860853 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:13:46.861092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:13:46.918174 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:13:46.919909 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:13:46.922285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:13:46.927001 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:13:46.927291 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:13:46.927540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:13:46.936863 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:13:46.937250 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:13:46.937505 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:13:46.939322 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:13:46.940621 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:13:46.941284 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:13:46.946603 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.946959 [debug] [MainThread]: On master: BEGIN
[0m06:13:46.947178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:13:46.956108 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:13:46.956507 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.956736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:13:46.959469 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:13:46.960550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9de3a30>]}
[0m06:13:46.960955 [debug] [MainThread]: On master: ROLLBACK
[0m06:13:46.961549 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.961765 [debug] [MainThread]: On master: BEGIN
[0m06:13:46.962662 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:13:46.962933 [debug] [MainThread]: On master: COMMIT
[0m06:13:46.963145 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:46.963441 [debug] [MainThread]: On master: COMMIT
[0m06:13:46.963963 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:13:46.964189 [debug] [MainThread]: On master: Close
[0m06:13:46.964809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:13:46.965134 [info ] [MainThread]: 
[0m06:13:46.980005 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:13:46.980549 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:13:46.981271 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:13:46.981655 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:13:46.983928 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:13:46.985631 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:13:46.981870 => 2025-05-14 06:13:46.985557
[0m06:13:46.985906 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:13:47.016163 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:13:47.018064 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:13:47.018346 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:13:47.018630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:13:47.027372 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:13:47.027739 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:13:47.027973 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."destination_db"."actors"
  );
  
[0m06:13:47.029184 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "destination_db.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
                          ^

[0m06:13:47.029509 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:13:47.030215 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:13:46.986075 => 2025-05-14 06:13:47.030135
[0m06:13:47.030452 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:13:47.036167 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "destination_db.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m06:13:47.036925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e788b0>]}
[0m06:13:47.037847 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.06s]
[0m06:13:47.039849 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:13:47.040354 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:13:47.040762 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:13:47.041463 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:13:47.041728 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:13:47.044294 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:13:47.045638 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:13:47.041889 => 2025-05-14 06:13:47.045304
[0m06:13:47.046081 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:13:47.049722 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:13:47.050508 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:13:47.050684 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:13:47.050838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:13:47.060284 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:13:47.060928 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:13:47.061195 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."destination_db"."actors"
  );
  
[0m06:13:47.062247 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "destination_db.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
                          ^

[0m06:13:47.062704 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:13:47.063365 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:13:47.046400 => 2025-05-14 06:13:47.063304
[0m06:13:47.063670 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:13:47.064587 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "destination_db.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:13:47.065035 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e046d0>]}
[0m06:13:47.065552 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:13:47.065945 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:13:47.066338 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:13:47.066739 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:13:47.067416 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:13:47.067675 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:13:47.069877 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:13:47.070756 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:13:47.067857 => 2025-05-14 06:13:47.070694
[0m06:13:47.070998 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:13:47.074672 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:13:47.075444 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:13:47.075621 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:13:47.075772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:13:47.085521 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:13:47.085893 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:13:47.086087 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."destination_db"."films"
  );
  
[0m06:13:47.086710 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "destination_db.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."destination_db"."films"
                          ^

[0m06:13:47.087000 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:13:47.087708 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:13:47.071160 => 2025-05-14 06:13:47.087639
[0m06:13:47.087968 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:13:47.088855 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "destination_db.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."destination_db"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m06:13:47.089250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10beaaf-c648-425c-af11-5897ad0a5c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e660b0>]}
[0m06:13:47.089723 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:13:47.090114 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:13:47.091716 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:13:47.092019 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.films_rating ....................................... [[33mSKIP[0m]
[0m06:13:47.092645 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:13:47.094611 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:13:47.095004 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:47.095221 [debug] [MainThread]: On master: BEGIN
[0m06:13:47.095415 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:13:47.104227 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:13:47.104658 [debug] [MainThread]: On master: COMMIT
[0m06:13:47.104861 [debug] [MainThread]: Using postgres connection "master"
[0m06:13:47.105051 [debug] [MainThread]: On master: COMMIT
[0m06:13:47.105594 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:13:47.105843 [debug] [MainThread]: On master: Close
[0m06:13:47.106488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:13:47.106709 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:13:47.106881 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:13:47.107440 [info ] [MainThread]: 
[0m06:13:47.107800 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m06:13:47.108318 [debug] [MainThread]: Command end result
[0m06:13:47.115068 [info ] [MainThread]: 
[0m06:13:47.115512 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:13:47.115930 [info ] [MainThread]: 
[0m06:13:47.116256 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m06:13:47.116537 [error] [MainThread]:   relation "destination_db.actors" does not exist
[0m06:13:47.116770 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
[0m06:13:47.117097 [error] [MainThread]:                             ^
[0m06:13:47.117398 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m06:13:47.117715 [info ] [MainThread]: 
[0m06:13:47.118014 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m06:13:47.118306 [error] [MainThread]:   relation "destination_db.actors" does not exist
[0m06:13:47.118608 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
[0m06:13:47.118909 [error] [MainThread]:                             ^
[0m06:13:47.119152 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:13:47.119518 [info ] [MainThread]: 
[0m06:13:47.119804 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m06:13:47.120038 [error] [MainThread]:   relation "destination_db.films" does not exist
[0m06:13:47.120300 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."destination_db"."films"
[0m06:13:47.120581 [error] [MainThread]:                             ^
[0m06:13:47.120830 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m06:13:47.121308 [info ] [MainThread]: 
[0m06:13:47.121662 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:13:47.122363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d50130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d504f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d503d0>]}
[0m06:13:47.122725 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:30:45.555846 | 55ce87b5-acd4-4caa-b90a-385596f0e70d ==============================
[0m06:30:45.555846 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:30:45.557994 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:30:45.560506 [debug] [MainThread]: Tracking: tracking
[0m06:30:45.577620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7214b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7213c0>]}
[0m06:30:45.590241 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:30:45.616238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m06:30:45.618728 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/actors.sql
[0m06:30:45.619644 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films.sql
[0m06:30:45.622566 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/film_actors.sql
[0m06:30:45.672006 [debug] [MainThread]: 1603: static parser failed on example/actors.sql
[0m06:30:45.678536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e039a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e3bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e44190>]}
[0m06:30:45.678878 [debug] [MainThread]: Flushing usage events
[0m06:30:46.887666 [error] [MainThread]: Encountered an error:
Compilation Error in model actors (models/example/actors.sql)
  source() takes exactly two arguments (1 given)


============================== 2025-05-14 06:32:13.147518 | 61828d29-7535-4465-b084-02115ea6694a ==============================
[0m06:32:13.147518 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:32:13.153633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:32:13.156686 [debug] [MainThread]: Tracking: tracking
[0m06:32:13.174694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:32:13.190090 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:32:13.202150 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m06:32:13.202835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723f70>]}
[0m06:32:13.694305 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m06:32:13.704585 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m06:32:13.706897 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m06:32:13.713120 [debug] [MainThread]: 1699: static parser successfully parsed example/films_rating.sql
[0m06:32:13.764876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f290c0>]}
[0m06:32:13.772082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb8d5690>]}
[0m06:32:13.772602 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:32:13.772969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723940>]}
[0m06:32:13.774542 [info ] [MainThread]: 
[0m06:32:13.776561 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:32:13.778499 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:32:13.787722 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:32:13.788093 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:32:13.788339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:32:13.839659 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:32:13.841371 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:32:13.843810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:32:13.848480 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:32:13.848752 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:32:13.848992 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:32:13.858668 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:32:13.859016 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:32:13.859218 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:32:13.861049 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:32:13.862361 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:32:13.863014 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:32:13.868272 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:13.868648 [debug] [MainThread]: On master: BEGIN
[0m06:32:13.868862 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:32:13.878319 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:32:13.878732 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:13.878953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:32:13.881447 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:32:13.882436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9decdf0>]}
[0m06:32:13.882838 [debug] [MainThread]: On master: ROLLBACK
[0m06:32:13.883449 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:13.883665 [debug] [MainThread]: On master: BEGIN
[0m06:32:13.884527 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:32:13.884763 [debug] [MainThread]: On master: COMMIT
[0m06:32:13.884966 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:13.885150 [debug] [MainThread]: On master: COMMIT
[0m06:32:13.885663 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:32:13.885884 [debug] [MainThread]: On master: Close
[0m06:32:13.886552 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:32:13.886974 [info ] [MainThread]: 
[0m06:32:13.899982 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:32:13.900482 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:32:13.901189 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:32:13.901476 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:32:13.903820 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:32:13.904844 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:32:13.901693 => 2025-05-14 06:32:13.904781
[0m06:32:13.905073 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:32:13.935394 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:32:13.936485 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:32:13.936701 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:32:13.936884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:13.946065 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:32:13.946375 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:32:13.946573 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."destination_db"."actors"
  );
  
[0m06:32:13.947807 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "destination_db.actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
                          ^

[0m06:32:13.948095 [debug] [Thread-1 (]: On model.custom_postgres.actors: ROLLBACK
[0m06:32:13.948804 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:32:13.905231 => 2025-05-14 06:32:13.948740
[0m06:32:13.949042 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:32:13.951240 [debug] [Thread-1 (]: Database Error in model actors (models/example/actors.sql)
  relation "destination_db.actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
                            ^
  compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m06:32:13.951663 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d48610>]}
[0m06:32:13.952432 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model public.actors ............................ [[31mERROR[0m in 0.05s]
[0m06:32:13.953945 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:32:13.954295 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:32:13.954690 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:32:13.955297 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:32:13.955547 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:32:13.958056 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:32:13.959146 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:32:13.955751 => 2025-05-14 06:32:13.959089
[0m06:32:13.959410 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:32:13.962736 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:32:13.963418 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:32:13.963598 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:32:13.963750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:13.973411 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:32:13.973777 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:32:13.973957 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."destination_db"."film_actors"
  );
  
[0m06:32:13.974558 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "destination_db.film_actors" does not exist
LINE 8:     SELECT * FROM "destination_db"."destination_db"."film_ac...
                          ^

[0m06:32:13.974750 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: ROLLBACK
[0m06:32:13.975253 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:32:13.959608 => 2025-05-14 06:32:13.975191
[0m06:32:13.975473 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:32:13.976376 [debug] [Thread-1 (]: Database Error in model film_actors (models/example/film_actors.sql)
  relation "destination_db.film_actors" does not exist
  LINE 8:     SELECT * FROM "destination_db"."destination_db"."film_ac...
                            ^
  compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:32:13.976874 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d4aef0>]}
[0m06:32:13.977284 [error] [Thread-1 (]: 2 of 4 ERROR creating sql table model public.film_actors ....................... [[31mERROR[0m in 0.02s]
[0m06:32:13.977708 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:32:13.979193 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:32:13.979732 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:32:13.980426 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:32:13.980694 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:32:13.983047 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:32:13.984755 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:32:13.980914 => 2025-05-14 06:32:13.984530
[0m06:32:13.985199 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:32:13.988631 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:32:13.989298 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:32:13.989493 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:32:13.989685 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:32:13.998818 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:32:13.999170 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:32:13.999342 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."destination_db"."films"
  );
  
[0m06:32:14.000051 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "destination_db.films" does not exist
LINE 8:     SELECT * FROM "destination_db"."destination_db"."films"
                          ^

[0m06:32:14.001397 [debug] [Thread-1 (]: On model.custom_postgres.films: ROLLBACK
[0m06:32:14.002252 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:32:13.985387 => 2025-05-14 06:32:14.002184
[0m06:32:14.002483 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:32:14.003381 [debug] [Thread-1 (]: Database Error in model films (models/example/films.sql)
  relation "destination_db.films" does not exist
  LINE 8:     SELECT * FROM "destination_db"."destination_db"."films"
                            ^
  compiled Code at target/run/custom_postgres/models/example/films.sql
[0m06:32:14.003943 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61828d29-7535-4465-b084-02115ea6694a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d4acb0>]}
[0m06:32:14.004421 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model public.films ............................. [[31mERROR[0m in 0.02s]
[0m06:32:14.004965 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:32:14.006658 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:32:14.006947 [info ] [Thread-1 (]: 4 of 4 SKIP relation public.films_rating ....................................... [[33mSKIP[0m]
[0m06:32:14.007311 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:32:14.008554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:32:14.008832 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:14.009063 [debug] [MainThread]: On master: BEGIN
[0m06:32:14.009260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:32:14.019175 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:32:14.019562 [debug] [MainThread]: On master: COMMIT
[0m06:32:14.019791 [debug] [MainThread]: Using postgres connection "master"
[0m06:32:14.020025 [debug] [MainThread]: On master: COMMIT
[0m06:32:14.020591 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:32:14.020837 [debug] [MainThread]: On master: Close
[0m06:32:14.021418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:32:14.021642 [debug] [MainThread]: Connection 'model.custom_postgres.films' was properly closed.
[0m06:32:14.022222 [info ] [MainThread]: 
[0m06:32:14.022891 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m06:32:14.023408 [debug] [MainThread]: Command end result
[0m06:32:14.029804 [info ] [MainThread]: 
[0m06:32:14.030446 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m06:32:14.030863 [info ] [MainThread]: 
[0m06:32:14.031198 [error] [MainThread]: [33mDatabase Error in model actors (models/example/actors.sql)[0m
[0m06:32:14.031572 [error] [MainThread]:   relation "destination_db.actors" does not exist
[0m06:32:14.031912 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."destination_db"."actors"
[0m06:32:14.032835 [error] [MainThread]:                             ^
[0m06:32:14.033670 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/actors.sql
[0m06:32:14.034051 [info ] [MainThread]: 
[0m06:32:14.034400 [error] [MainThread]: [33mDatabase Error in model film_actors (models/example/film_actors.sql)[0m
[0m06:32:14.034818 [error] [MainThread]:   relation "destination_db.film_actors" does not exist
[0m06:32:14.035178 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."destination_db"."film_ac...
[0m06:32:14.035773 [error] [MainThread]:                             ^
[0m06:32:14.036199 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/film_actors.sql
[0m06:32:14.036554 [info ] [MainThread]: 
[0m06:32:14.037000 [error] [MainThread]: [33mDatabase Error in model films (models/example/films.sql)[0m
[0m06:32:14.037409 [error] [MainThread]:   relation "destination_db.films" does not exist
[0m06:32:14.037864 [error] [MainThread]:   LINE 8:     SELECT * FROM "destination_db"."destination_db"."films"
[0m06:32:14.038226 [error] [MainThread]:                             ^
[0m06:32:14.038630 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films.sql
[0m06:32:14.039035 [info ] [MainThread]: 
[0m06:32:14.039563 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=1 TOTAL=4
[0m06:32:14.040322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e81de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7215d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e1fca0>]}
[0m06:32:14.041367 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:40:36.184610 | d55c3935-1af0-454d-8b89-ed71ed02413f ==============================
[0m06:40:36.184610 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:40:36.188532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:40:36.191276 [debug] [MainThread]: Tracking: tracking
[0m06:40:36.210591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:40:36.224597 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:40:36.250494 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:40:36.251280 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/source.yml
[0m06:40:36.307749 [debug] [MainThread]: 1699: static parser successfully parsed example/films_rating.sql
[0m06:40:36.321741 [debug] [MainThread]: 1699: static parser successfully parsed example/films.sql
[0m06:40:36.324121 [debug] [MainThread]: 1699: static parser successfully parsed example/actors.sql
[0m06:40:36.326282 [debug] [MainThread]: 1699: static parser successfully parsed example/film_actors.sql
[0m06:40:36.358827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8cc99c0>]}
[0m06:40:36.367778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e82500>]}
[0m06:40:36.368248 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:40:36.368608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd166da0>]}
[0m06:40:36.370684 [info ] [MainThread]: 
[0m06:40:36.372714 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:36.374682 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:40:36.383904 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:40:36.384259 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:40:36.384547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:36.433687 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:40:36.435423 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:40:36.437986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:40:36.442667 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:40:36.442930 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:40:36.443135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:40:36.453999 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:40:36.454509 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:40:36.454783 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:40:36.456790 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:40:36.458266 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:40:36.458887 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:40:36.464708 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:36.465225 [debug] [MainThread]: On master: BEGIN
[0m06:40:36.465458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:40:36.475376 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:40:36.475755 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:36.475961 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:40:36.478420 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:40:36.479383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7226b0>]}
[0m06:40:36.479767 [debug] [MainThread]: On master: ROLLBACK
[0m06:40:36.480327 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:36.480569 [debug] [MainThread]: On master: BEGIN
[0m06:40:36.481439 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:40:36.481709 [debug] [MainThread]: On master: COMMIT
[0m06:40:36.481954 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:36.482159 [debug] [MainThread]: On master: COMMIT
[0m06:40:36.482724 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:40:36.482939 [debug] [MainThread]: On master: Close
[0m06:40:36.483565 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:40:36.483955 [info ] [MainThread]: 
[0m06:40:36.496932 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:40:36.497473 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:40:36.498202 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:40:36.498549 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:40:36.500804 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:40:36.501883 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:40:36.498751 => 2025-05-14 06:40:36.501817
[0m06:40:36.502137 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:40:36.532708 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:40:36.533878 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:36.534087 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:40:36.534271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:36.542568 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:40:36.542897 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:36.543083 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:40:36.544129 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:40:36.549529 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:36.549828 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:40:36.550567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:40:36.552557 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:36.552777 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:40:36.553440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:40:36.569823 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:40:36.570113 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:36.570328 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:40:36.571272 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:40:36.574978 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:40:36.575216 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:40:36.576753 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:40:36.577809 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:40:36.502312 => 2025-05-14 06:40:36.577763
[0m06:40:36.578028 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:40:36.578747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d3d270>]}
[0m06:40:36.579664 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m06:40:36.581358 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:40:36.581710 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:40:36.582041 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:40:36.582567 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:40:36.582766 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:40:36.584831 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:40:36.585538 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:40:36.582944 => 2025-05-14 06:40:36.585492
[0m06:40:36.585736 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:40:36.588895 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:40:36.589469 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:36.589631 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:40:36.589776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:36.598984 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:40:36.599383 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:36.599576 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:40:36.600546 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:40:36.602756 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:36.602983 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:40:36.603578 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:40:36.605528 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:36.605748 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:40:36.606411 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:40:36.607996 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:40:36.608208 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:36.608401 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:40:36.609250 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:40:36.610871 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:40:36.611056 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:40:36.612365 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:40:36.613402 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:40:36.585869 => 2025-05-14 06:40:36.613358
[0m06:40:36.613606 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:40:36.614359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e898d0>]}
[0m06:40:36.614761 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:40:36.615249 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:40:36.615529 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:40:36.615825 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:40:36.616358 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:40:36.616586 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:40:36.619428 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:40:36.620126 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:40:36.616737 => 2025-05-14 06:40:36.620079
[0m06:40:36.620333 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:40:36.623714 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:40:36.624638 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:36.624827 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:40:36.624988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:36.633342 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:40:36.633678 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:36.633874 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:40:36.634903 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:40:36.637101 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:36.637343 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:40:36.637916 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:40:36.639817 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:36.640025 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:40:36.640650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:40:36.642228 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:40:36.642446 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:36.642623 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:40:36.643404 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:40:36.644967 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:40:36.645179 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:40:36.646630 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:40:36.647720 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:40:36.620463 => 2025-05-14 06:40:36.647664
[0m06:40:36.647975 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:40:36.648677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e8bca0>]}
[0m06:40:36.649104 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:40:36.649650 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:40:36.650936 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:40:36.651379 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films_rating ............................... [RUN]
[0m06:40:36.651915 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m06:40:36.652133 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m06:40:36.654780 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m06:40:36.655462 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 06:40:36.652285 => 2025-05-14 06:40:36.655413
[0m06:40:36.655663 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m06:40:36.658751 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m06:40:36.659760 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:40:36.659920 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m06:40:36.660065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:40:36.668541 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:40:36.668865 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:40:36.669060 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    WITH films_with_rating AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:40:36.670603 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films_with_ratings" does not exist
LINE 38: FROM films_with_ratings fwf
              ^

[0m06:40:36.670872 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: ROLLBACK
[0m06:40:36.671455 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 06:40:36.655794 => 2025-05-14 06:40:36.671402
[0m06:40:36.671643 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m06:40:36.675414 [debug] [Thread-1 (]: Database Error in model films_rating (models/example/films_rating.sql)
  relation "films_with_ratings" does not exist
  LINE 38: FROM films_with_ratings fwf
                ^
  compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:40:36.676028 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd55c3935-1af0-454d-8b89-ed71ed02413f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d727a0>]}
[0m06:40:36.676492 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films_rating ...................... [[31mERROR[0m in 0.02s]
[0m06:40:36.677024 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:40:36.678465 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:40:36.678746 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:36.678995 [debug] [MainThread]: On master: BEGIN
[0m06:40:36.679287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:40:36.689124 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:40:36.689612 [debug] [MainThread]: On master: COMMIT
[0m06:40:36.689839 [debug] [MainThread]: Using postgres connection "master"
[0m06:40:36.690045 [debug] [MainThread]: On master: COMMIT
[0m06:40:36.690641 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:40:36.690890 [debug] [MainThread]: On master: Close
[0m06:40:36.691484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:40:36.691702 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:40:36.691877 [debug] [MainThread]: Connection 'model.custom_postgres.films_rating' was properly closed.
[0m06:40:36.692474 [info ] [MainThread]: 
[0m06:40:36.692842 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m06:40:36.693329 [debug] [MainThread]: Command end result
[0m06:40:36.698563 [info ] [MainThread]: 
[0m06:40:36.698996 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:40:36.699368 [info ] [MainThread]: 
[0m06:40:36.699634 [error] [MainThread]: [33mDatabase Error in model films_rating (models/example/films_rating.sql)[0m
[0m06:40:36.699967 [error] [MainThread]:   relation "films_with_ratings" does not exist
[0m06:40:36.700216 [error] [MainThread]:   LINE 38: FROM films_with_ratings fwf
[0m06:40:36.700688 [error] [MainThread]:                 ^
[0m06:40:36.700960 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:40:36.701233 [info ] [MainThread]: 
[0m06:40:36.701527 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:40:36.701870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e81870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d87a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d06f80>]}
[0m06:40:36.702158 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:43:07.835211 | f3807f5f-7501-47c3-a3bd-8f0f95a7068f ==============================
[0m06:43:07.835211 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:43:07.838871 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:43:07.839190 [debug] [MainThread]: Tracking: tracking
[0m06:43:07.854543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:43:07.866373 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:43:07.892521 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:43:07.892892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:43:07.903378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e2e200>]}
[0m06:43:07.918365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dfb7f0>]}
[0m06:43:07.918771 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:43:07.919125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dfb880>]}
[0m06:43:07.920804 [info ] [MainThread]: 
[0m06:43:07.922967 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:07.925351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:43:07.934998 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:43:07.935443 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:43:07.935708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:07.986951 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:43:07.988622 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:43:07.991239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:43:07.995852 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:43:07.996124 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:43:07.996331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:43:08.005498 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:43:08.005933 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:43:08.006182 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:43:08.007950 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:43:08.009035 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:43:08.009685 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:43:08.014825 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:08.015164 [debug] [MainThread]: On master: BEGIN
[0m06:43:08.015397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:08.023669 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:08.024060 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:08.024281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:08.026954 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:43:08.028089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e724d0>]}
[0m06:43:08.028464 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:08.029039 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:08.029259 [debug] [MainThread]: On master: BEGIN
[0m06:43:08.030105 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:08.030367 [debug] [MainThread]: On master: COMMIT
[0m06:43:08.030585 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:08.030795 [debug] [MainThread]: On master: COMMIT
[0m06:43:08.031331 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:43:08.031546 [debug] [MainThread]: On master: Close
[0m06:43:08.032130 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:43:08.032437 [info ] [MainThread]: 
[0m06:43:08.044803 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:43:08.045309 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:43:08.045996 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:43:08.046247 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:43:08.048308 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:43:08.049310 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:43:08.046428 => 2025-05-14 06:43:08.049244
[0m06:43:08.049552 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:43:08.079073 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:43:08.080250 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:08.080469 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:43:08.080657 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:08.089196 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:08.089519 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:08.089701 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:43:08.090773 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:43:08.096183 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:08.096437 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:43:08.097124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:08.099136 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:08.099357 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:43:08.099994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:08.116741 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:43:08.117048 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:08.117242 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:43:08.118267 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:08.121912 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:08.122135 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:43:08.123780 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:08.124845 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:43:08.049715 => 2025-05-14 06:43:08.124796
[0m06:43:08.125112 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:43:08.125854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cdc580>]}
[0m06:43:08.126781 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m06:43:08.128328 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:43:08.128643 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:43:08.128948 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:43:08.129496 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:43:08.129728 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:43:08.131790 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:43:08.132465 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:43:08.129895 => 2025-05-14 06:43:08.132415
[0m06:43:08.132687 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:43:08.135861 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:43:08.136420 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:08.136579 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:43:08.136731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:08.145238 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:08.145612 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:08.145815 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:43:08.146879 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:43:08.149241 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:08.149475 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:43:08.150103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:08.152020 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:08.152231 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:43:08.152823 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:08.154405 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:43:08.154619 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:08.154798 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:43:08.155542 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:08.157122 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:08.157339 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:43:08.158681 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:08.159659 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:43:08.132839 => 2025-05-14 06:43:08.159615
[0m06:43:08.159875 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:43:08.160658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e83a00>]}
[0m06:43:08.161112 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:43:08.161654 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:43:08.161988 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:43:08.162302 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:43:08.162867 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:43:08.163074 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:43:08.165184 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:43:08.165862 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:43:08.163214 => 2025-05-14 06:43:08.165814
[0m06:43:08.166056 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:43:08.170004 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:43:08.170630 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:08.170812 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:43:08.170965 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:08.179070 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:08.179402 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:08.179592 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:43:08.180588 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:43:08.182799 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:08.183005 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:43:08.183531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:08.185405 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:08.185616 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:43:08.186185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:08.187754 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:43:08.188013 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:08.188224 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:43:08.189013 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:08.190524 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:08.190734 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:43:08.192141 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:08.193152 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:43:08.166187 => 2025-05-14 06:43:08.193108
[0m06:43:08.193373 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:43:08.194107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e727a0>]}
[0m06:43:08.194502 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:43:08.194997 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:43:08.196471 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:43:08.196733 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films_rating ............................... [RUN]
[0m06:43:08.197270 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m06:43:08.197506 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m06:43:08.200167 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m06:43:08.200857 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 06:43:08.197656 => 2025-05-14 06:43:08.200806
[0m06:43:08.201057 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m06:43:08.204094 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m06:43:08.204710 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:43:08.204930 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m06:43:08.205107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:08.214609 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:08.214979 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:43:08.215161 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    WITH films_with_rating AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:43:08.216573 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "films_with_ratings" does not exist
LINE 38: FROM films_with_ratings fwf
              ^

[0m06:43:08.216802 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: ROLLBACK
[0m06:43:08.217424 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 06:43:08.201191 => 2025-05-14 06:43:08.217368
[0m06:43:08.217647 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m06:43:08.219706 [debug] [Thread-1 (]: Database Error in model films_rating (models/example/films_rating.sql)
  relation "films_with_ratings" does not exist
  LINE 38: FROM films_with_ratings fwf
                ^
  compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:43:08.220377 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3807f5f-7501-47c3-a3bd-8f0f95a7068f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e8ea10>]}
[0m06:43:08.220999 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films_rating ...................... [[31mERROR[0m in 0.02s]
[0m06:43:08.221718 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:43:08.224188 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:08.224631 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:08.225049 [debug] [MainThread]: On master: BEGIN
[0m06:43:08.225433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:08.235104 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:08.235494 [debug] [MainThread]: On master: COMMIT
[0m06:43:08.235746 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:08.235984 [debug] [MainThread]: On master: COMMIT
[0m06:43:08.236562 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:43:08.236843 [debug] [MainThread]: On master: Close
[0m06:43:08.237471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:08.237689 [debug] [MainThread]: Connection 'model.custom_postgres.films_rating' was properly closed.
[0m06:43:08.238320 [info ] [MainThread]: 
[0m06:43:08.238669 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m06:43:08.239345 [debug] [MainThread]: Command end result
[0m06:43:08.244685 [info ] [MainThread]: 
[0m06:43:08.245182 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:43:08.245808 [info ] [MainThread]: 
[0m06:43:08.246163 [error] [MainThread]: [33mDatabase Error in model films_rating (models/example/films_rating.sql)[0m
[0m06:43:08.246509 [error] [MainThread]:   relation "films_with_ratings" does not exist
[0m06:43:08.246858 [error] [MainThread]:   LINE 38: FROM films_with_ratings fwf
[0m06:43:08.247216 [error] [MainThread]:                 ^
[0m06:43:08.247753 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:43:08.248596 [info ] [MainThread]: 
[0m06:43:08.249076 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:43:08.249587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d6bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dfae30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9dfb220>]}
[0m06:43:08.249874 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:43:41.376266 | c495659b-bf52-4019-95bb-340c179c5d43 ==============================
[0m06:43:41.376266 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:43:41.379931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:43:41.382844 [debug] [MainThread]: Tracking: tracking
[0m06:43:41.397552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721360>]}
[0m06:43:41.409377 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:43:41.435069 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:43:41.435607 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films_rating.sql
[0m06:43:41.492908 [debug] [MainThread]: 1699: static parser successfully parsed example/films_rating.sql
[0m06:43:41.513359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e700d0>]}
[0m06:43:41.520540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9debf10>]}
[0m06:43:41.521016 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:43:41.521388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffd1a25c0>]}
[0m06:43:41.523075 [info ] [MainThread]: 
[0m06:43:41.525093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:41.526955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:43:41.536175 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:43:41.536534 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:43:41.536775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:41.624120 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:43:41.625940 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:43:41.628311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:43:41.633033 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:43:41.633318 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:43:41.633531 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:43:41.643113 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:43:41.643477 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:43:41.643695 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:43:41.645426 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:43:41.646542 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:43:41.647171 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:43:41.652550 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:41.652948 [debug] [MainThread]: On master: BEGIN
[0m06:43:41.653178 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:43:41.663500 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:41.663992 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:41.664229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:43:41.667106 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:43:41.668136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8cb8730>]}
[0m06:43:41.668528 [debug] [MainThread]: On master: ROLLBACK
[0m06:43:41.669151 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:41.669387 [debug] [MainThread]: On master: BEGIN
[0m06:43:41.670311 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:41.670660 [debug] [MainThread]: On master: COMMIT
[0m06:43:41.670927 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:41.671158 [debug] [MainThread]: On master: COMMIT
[0m06:43:41.671702 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:43:41.671928 [debug] [MainThread]: On master: Close
[0m06:43:41.672593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:43:41.672935 [info ] [MainThread]: 
[0m06:43:41.687601 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:43:41.688290 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:43:41.689015 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:43:41.689434 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:43:41.691847 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:43:41.693496 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:43:41.689707 => 2025-05-14 06:43:41.693389
[0m06:43:41.693931 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:43:41.724910 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:43:41.726130 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:41.726348 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:43:41.726536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:41.735168 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:41.735487 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:41.735654 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:43:41.736925 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:43:41.741886 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:41.742161 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:43:41.742858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:41.744826 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:41.745069 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:43:41.745813 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:41.762184 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:43:41.762479 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:41.762676 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:43:41.763645 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:41.767395 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:43:41.767679 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:43:41.769331 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:41.770481 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:43:41.694122 => 2025-05-14 06:43:41.770433
[0m06:43:41.770734 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:43:41.771589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d55480>]}
[0m06:43:41.772520 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m06:43:41.774062 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:43:41.774401 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:43:41.774720 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:43:41.775273 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:43:41.775498 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:43:41.777663 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:43:41.778376 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:43:41.775694 => 2025-05-14 06:43:41.778327
[0m06:43:41.778574 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:43:41.782618 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:43:41.783363 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:41.783541 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:43:41.783695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:41.792506 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:41.792871 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:41.793056 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:43:41.794144 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:43:41.796364 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:41.796568 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:43:41.797176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:41.799033 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:41.799236 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:43:41.799800 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:41.801395 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:43:41.801610 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:41.801810 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:43:41.802582 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:41.804324 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:43:41.804548 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:43:41.805831 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:41.806758 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:43:41.778706 => 2025-05-14 06:43:41.806717
[0m06:43:41.806997 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:43:41.807754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e82dd0>]}
[0m06:43:41.808218 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:43:41.808751 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:43:41.809075 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:43:41.809378 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:43:41.809961 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:43:41.810191 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:43:41.812326 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:43:41.813015 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:43:41.810342 => 2025-05-14 06:43:41.812964
[0m06:43:41.813227 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:43:41.816431 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:43:41.816978 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:41.817137 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:43:41.817292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:41.826609 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:41.826935 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:41.827101 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:43:41.828151 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:43:41.830395 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:41.830620 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:43:41.831164 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:41.833051 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:41.833279 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:43:41.833847 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:43:41.835553 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:43:41.835778 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:41.835991 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:43:41.836805 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:43:41.838540 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:43:41.838758 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:43:41.840204 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:43:41.841187 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:43:41.813363 => 2025-05-14 06:43:41.841144
[0m06:43:41.841400 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:43:41.842097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d76e90>]}
[0m06:43:41.842503 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:43:41.843002 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:43:41.844576 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:43:41.844875 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films_rating ............................... [RUN]
[0m06:43:41.845455 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m06:43:41.845703 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m06:43:41.849324 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m06:43:41.850206 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 06:43:41.845867 => 2025-05-14 06:43:41.850151
[0m06:43:41.850437 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m06:43:41.853550 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m06:43:41.854131 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:43:41.854301 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m06:43:41.854450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:43:41.863338 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:43:41.863661 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:43:41.863923 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,ß
        rating,
        user_rating,
        CASE 
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:43:41.865039 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ß" does not exist
LINE 13:         price,ß
                       ^

[0m06:43:41.865277 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: ROLLBACK
[0m06:43:41.865841 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 06:43:41.850607 => 2025-05-14 06:43:41.865767
[0m06:43:41.866045 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m06:43:41.868236 [debug] [Thread-1 (]: Database Error in model films_rating (models/example/films_rating.sql)
  column "ß" does not exist
  LINE 13:         price,ß
                         ^
  compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:43:41.868691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c495659b-bf52-4019-95bb-340c179c5d43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839fc70>]}
[0m06:43:41.870183 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films_rating ...................... [[31mERROR[0m in 0.02s]
[0m06:43:41.871681 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:43:41.873300 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:43:41.873633 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:41.873881 [debug] [MainThread]: On master: BEGIN
[0m06:43:41.874169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:43:41.886053 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:43:41.886611 [debug] [MainThread]: On master: COMMIT
[0m06:43:41.886849 [debug] [MainThread]: Using postgres connection "master"
[0m06:43:41.887082 [debug] [MainThread]: On master: COMMIT
[0m06:43:41.887744 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:43:41.888031 [debug] [MainThread]: On master: Close
[0m06:43:41.888655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:43:41.888902 [debug] [MainThread]: Connection 'list_destination_db' was properly closed.
[0m06:43:41.889092 [debug] [MainThread]: Connection 'model.custom_postgres.films_rating' was properly closed.
[0m06:43:41.889633 [info ] [MainThread]: 
[0m06:43:41.889982 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m06:43:41.890502 [debug] [MainThread]: Command end result
[0m06:43:41.896583 [info ] [MainThread]: 
[0m06:43:41.897039 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:43:41.897581 [info ] [MainThread]: 
[0m06:43:41.897950 [error] [MainThread]: [33mDatabase Error in model films_rating (models/example/films_rating.sql)[0m
[0m06:43:41.898255 [error] [MainThread]:   column "ß" does not exist
[0m06:43:41.898626 [error] [MainThread]:   LINE 13:         price,ß
[0m06:43:41.898914 [error] [MainThread]:                          ^
[0m06:43:41.899196 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:43:41.899445 [info ] [MainThread]: 
[0m06:43:41.899676 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:43:41.900068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d999c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839f7c0>]}
[0m06:43:41.900352 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:44:58.692717 | d3e580d6-4508-4207-8afc-e54dc6080024 ==============================
[0m06:44:58.692717 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:44:58.696598 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:44:58.699392 [debug] [MainThread]: Tracking: tracking
[0m06:44:58.715067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:44:58.727787 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:44:58.754081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:44:58.754436 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:44:58.762309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e2e200>]}
[0m06:44:58.770468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f837f0>]}
[0m06:44:58.770898 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:44:58.771280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f83880>]}
[0m06:44:58.772871 [info ] [MainThread]: 
[0m06:44:58.775079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:44:58.777422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:44:58.788467 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:44:58.788925 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:44:58.789184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:44:58.840605 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:44:58.842494 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:44:58.845273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:44:58.850222 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:44:58.850499 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:44:58.850707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:44:58.859791 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:44:58.860134 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:44:58.860379 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:44:58.862175 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:44:58.863324 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:44:58.863981 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:44:58.869535 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:58.869898 [debug] [MainThread]: On master: BEGIN
[0m06:44:58.870119 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:44:58.878867 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:44:58.879205 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:58.879487 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:44:58.881977 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:44:58.883131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e6e4d0>]}
[0m06:44:58.883543 [debug] [MainThread]: On master: ROLLBACK
[0m06:44:58.884121 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:58.884360 [debug] [MainThread]: On master: BEGIN
[0m06:44:58.885336 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:44:58.885576 [debug] [MainThread]: On master: COMMIT
[0m06:44:58.885778 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:58.885968 [debug] [MainThread]: On master: COMMIT
[0m06:44:58.886487 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:44:58.886709 [debug] [MainThread]: On master: Close
[0m06:44:58.887316 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:44:58.887651 [info ] [MainThread]: 
[0m06:44:58.900717 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:44:58.901208 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:44:58.901889 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:44:58.902151 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:44:58.904349 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:44:58.905342 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:44:58.902338 => 2025-05-14 06:44:58.905281
[0m06:44:58.905572 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:44:58.938222 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:44:58.939519 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:44:58.939754 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:44:58.939946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:44:58.948938 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:44:58.949293 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:44:58.949553 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:44:58.950797 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:44:58.955849 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:44:58.956127 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:44:58.956881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:44:58.958935 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:44:58.959153 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:44:58.959744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:44:58.976499 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:44:58.976797 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:44:58.976986 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:44:58.977893 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:44:58.981572 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:44:58.981784 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:44:58.983249 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:44:58.984338 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:44:58.905728 => 2025-05-14 06:44:58.984290
[0m06:44:58.984549 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:44:58.985357 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9cdc580>]}
[0m06:44:58.986319 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m06:44:58.987858 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:44:58.988193 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:44:58.988530 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:44:58.989095 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:44:58.989343 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:44:58.991522 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:44:58.992285 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:44:58.989496 => 2025-05-14 06:44:58.992215
[0m06:44:58.992506 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:44:58.995844 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:44:58.996548 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:44:58.996724 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:44:58.996883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:44:59.005832 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:44:59.006332 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:44:59.006554 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:44:59.007564 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:44:59.009857 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:44:59.010078 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:44:59.010761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:44:59.013185 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:44:59.013480 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:44:59.014208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:44:59.015896 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:44:59.016106 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:44:59.016278 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:44:59.017078 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:44:59.018708 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:44:59.018893 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:44:59.020152 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:44:59.021160 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:44:58.992644 => 2025-05-14 06:44:59.021114
[0m06:44:59.021408 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:44:59.022167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e7ba00>]}
[0m06:44:59.022576 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:44:59.023109 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:44:59.023423 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:44:59.023715 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:44:59.024272 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:44:59.024479 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:44:59.026794 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:44:59.027702 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:44:59.024631 => 2025-05-14 06:44:59.027636
[0m06:44:59.027935 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:44:59.032542 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:44:59.033689 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:44:59.033953 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:44:59.034153 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:44:59.042995 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:44:59.043349 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:44:59.043572 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:44:59.044803 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:44:59.047149 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:44:59.047428 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:44:59.048161 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:44:59.050160 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:44:59.050385 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:44:59.051000 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:44:59.052583 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:44:59.052790 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:44:59.052960 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:44:59.053759 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:44:59.055354 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:44:59.055569 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:44:59.057087 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:44:59.058048 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:44:59.028075 => 2025-05-14 06:44:59.058006
[0m06:44:59.058282 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:44:59.058996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e6d9f0>]}
[0m06:44:59.059442 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:44:59.060424 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:44:59.062188 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:44:59.062530 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films_rating ............................... [RUN]
[0m06:44:59.063123 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m06:44:59.063361 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m06:44:59.066370 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m06:44:59.067250 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 06:44:59.063513 => 2025-05-14 06:44:59.067179
[0m06:44:59.067491 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m06:44:59.070688 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m06:44:59.071305 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:44:59.071475 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m06:44:59.071626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:44:59.081694 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:44:59.082054 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:44:59.082257 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,ß
        rating,
        user_rating,
        CASE 
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:44:59.083430 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "ß" does not exist
LINE 13:         price,ß
                       ^

[0m06:44:59.083682 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: ROLLBACK
[0m06:44:59.084353 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 06:44:59.067650 => 2025-05-14 06:44:59.084292
[0m06:44:59.084622 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m06:44:59.087287 [debug] [Thread-1 (]: Database Error in model films_rating (models/example/films_rating.sql)
  column "ß" does not exist
  LINE 13:         price,ß
                         ^
  compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:44:59.087905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3e580d6-4508-4207-8afc-e54dc6080024', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9eaf4f0>]}
[0m06:44:59.088378 [error] [Thread-1 (]: 4 of 4 ERROR creating sql table model public.films_rating ...................... [[31mERROR[0m in 0.03s]
[0m06:44:59.089140 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:44:59.090644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:44:59.090978 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:59.091287 [debug] [MainThread]: On master: BEGIN
[0m06:44:59.091623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:44:59.101991 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:44:59.102474 [debug] [MainThread]: On master: COMMIT
[0m06:44:59.102707 [debug] [MainThread]: Using postgres connection "master"
[0m06:44:59.102909 [debug] [MainThread]: On master: COMMIT
[0m06:44:59.103469 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:44:59.103732 [debug] [MainThread]: On master: Close
[0m06:44:59.104356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:44:59.104605 [debug] [MainThread]: Connection 'model.custom_postgres.films_rating' was properly closed.
[0m06:44:59.105154 [info ] [MainThread]: 
[0m06:44:59.105696 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m06:44:59.106241 [debug] [MainThread]: Command end result
[0m06:44:59.112650 [info ] [MainThread]: 
[0m06:44:59.113083 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:44:59.113483 [info ] [MainThread]: 
[0m06:44:59.113830 [error] [MainThread]: [33mDatabase Error in model films_rating (models/example/films_rating.sql)[0m
[0m06:44:59.114093 [error] [MainThread]:   column "ß" does not exist
[0m06:44:59.114470 [error] [MainThread]:   LINE 13:         price,ß
[0m06:44:59.114757 [error] [MainThread]:                          ^
[0m06:44:59.114995 [error] [MainThread]:   compiled Code at target/run/custom_postgres/models/example/films_rating.sql
[0m06:44:59.115255 [info ] [MainThread]: 
[0m06:44:59.115584 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m06:44:59.115950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d77f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f82170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f83220>]}
[0m06:44:59.116247 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:45:15.639601 | 47538e28-7fcb-4da7-8efc-47a601ec295e ==============================
[0m06:45:15.639601 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:45:15.643115 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:45:15.643364 [debug] [MainThread]: Tracking: tracking
[0m06:45:15.658607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:45:15.670350 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:45:15.695706 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:45:15.696264 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films_rating.sql
[0m06:45:15.754035 [debug] [MainThread]: 1699: static parser successfully parsed example/films_rating.sql
[0m06:45:15.775020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e780d0>]}
[0m06:45:15.782928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9debee0>]}
[0m06:45:15.783528 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:45:15.784035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72e2f0>]}
[0m06:45:15.785518 [info ] [MainThread]: 
[0m06:45:15.787446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:45:15.789544 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:45:15.799828 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:45:15.800273 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:45:15.800605 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:15.849599 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:45:15.851257 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:45:15.853906 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:45:15.858545 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:45:15.858820 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:45:15.859025 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:45:15.868224 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:45:15.868653 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:45:15.868879 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:45:15.870566 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:45:15.871694 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:45:15.872287 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:45:15.877531 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:15.877902 [debug] [MainThread]: On master: BEGIN
[0m06:45:15.878124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:45:15.887577 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:45:15.888025 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:15.888323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:45:15.891378 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:45:15.892650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8cb4850>]}
[0m06:45:15.893148 [debug] [MainThread]: On master: ROLLBACK
[0m06:45:15.893822 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:15.894143 [debug] [MainThread]: On master: BEGIN
[0m06:45:15.895194 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:45:15.895474 [debug] [MainThread]: On master: COMMIT
[0m06:45:15.895715 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:15.895939 [debug] [MainThread]: On master: COMMIT
[0m06:45:15.896553 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:45:15.896845 [debug] [MainThread]: On master: Close
[0m06:45:15.897574 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:45:15.897949 [info ] [MainThread]: 
[0m06:45:15.914415 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:45:15.914930 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:45:15.915623 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:45:15.915957 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:45:15.918606 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:45:15.919945 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:45:15.916244 => 2025-05-14 06:45:15.919878
[0m06:45:15.920250 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:45:15.950285 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:45:15.951480 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:15.951693 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:45:15.951879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:15.960328 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:45:15.960632 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:15.960828 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:45:15.961866 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:45:15.967182 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:15.967480 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:45:15.968216 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:45:15.970250 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:15.970481 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:45:15.971049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:45:15.987084 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:45:15.987432 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:15.987635 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:45:15.988530 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:45:15.992259 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:45:15.992489 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:45:15.993969 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:45:15.995006 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:45:15.920427 => 2025-05-14 06:45:15.994961
[0m06:45:15.995240 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:45:15.995933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d55480>]}
[0m06:45:15.996844 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m06:45:15.998379 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:45:15.998686 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:45:15.998998 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:45:15.999560 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:45:15.999787 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:45:16.001902 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:45:16.002556 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:45:15.999926 => 2025-05-14 06:45:16.002511
[0m06:45:16.002772 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:45:16.006618 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:45:16.007223 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:16.007401 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:45:16.007553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:16.016099 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:45:16.016429 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:16.016595 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:45:16.017584 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:45:16.019811 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:16.020041 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:45:16.020555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:45:16.022441 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:16.022653 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:45:16.023294 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:45:16.024857 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:45:16.025066 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:16.025247 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:45:16.026054 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:45:16.027666 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:45:16.027871 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:45:16.029173 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:45:16.030137 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:45:16.002930 => 2025-05-14 06:45:16.030094
[0m06:45:16.030352 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:45:16.031047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e85ba0>]}
[0m06:45:16.031446 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:45:16.031973 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:45:16.032292 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:45:16.032612 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:45:16.033166 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:45:16.033445 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:45:16.035563 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:45:16.036277 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:45:16.033595 => 2025-05-14 06:45:16.036218
[0m06:45:16.036497 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:45:16.039677 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:45:16.040254 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:16.040432 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:45:16.040612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:16.050012 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:45:16.050388 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:16.050587 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:45:16.051626 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:45:16.053840 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:16.054077 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:45:16.054685 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:45:16.056594 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:16.056853 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:45:16.057453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:45:16.059112 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:45:16.059367 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:16.059566 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:45:16.060463 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:45:16.062169 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:45:16.062377 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:45:16.063683 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:45:16.064691 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:45:16.036634 => 2025-05-14 06:45:16.064648
[0m06:45:16.064917 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:45:16.065605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d74640>]}
[0m06:45:16.066067 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:45:16.066392 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:45:16.068050 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:45:16.068335 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films_rating ............................... [RUN]
[0m06:45:16.068852 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m06:45:16.069070 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m06:45:16.072485 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m06:45:16.073195 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 06:45:16.069210 => 2025-05-14 06:45:16.073147
[0m06:45:16.073405 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m06:45:16.076479 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m06:45:16.077020 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:45:16.077184 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m06:45:16.077416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:16.085923 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:45:16.086215 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:45:16.086438 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id
  );
  
[0m06:45:16.089280 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:45:16.091602 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:45:16.091805 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
alter table "destination_db"."public"."films_rating__dbt_tmp" rename to "films_rating"
[0m06:45:16.092351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:45:16.093682 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m06:45:16.093878 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:45:16.094027 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m06:45:16.094592 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:45:16.096099 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:45:16.096299 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
drop table if exists "destination_db"."public"."films_rating__dbt_backup" cascade
[0m06:45:16.096819 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:45:16.097818 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 06:45:16.073535 => 2025-05-14 06:45:16.097770
[0m06:45:16.098081 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m06:45:16.098871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47538e28-7fcb-4da7-8efc-47a601ec295e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a3bb0>]}
[0m06:45:16.099325 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films_rating .......................... [[32mSELECT 20[0m in 0.03s]
[0m06:45:16.099936 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:45:16.101275 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:45:16.101609 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:16.101824 [debug] [MainThread]: On master: BEGIN
[0m06:45:16.101996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:45:16.111048 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:45:16.111491 [debug] [MainThread]: On master: COMMIT
[0m06:45:16.111719 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:16.111915 [debug] [MainThread]: On master: COMMIT
[0m06:45:16.112551 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:45:16.112802 [debug] [MainThread]: On master: Close
[0m06:45:16.113398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:45:16.113612 [debug] [MainThread]: Connection 'model.custom_postgres.films_rating' was properly closed.
[0m06:45:16.114162 [info ] [MainThread]: 
[0m06:45:16.114504 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m06:45:16.115038 [debug] [MainThread]: Command end result
[0m06:45:16.120589 [info ] [MainThread]: 
[0m06:45:16.120981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:45:16.121361 [info ] [MainThread]: 
[0m06:45:16.121670 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:45:16.122070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9debbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d430a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83a3610>]}
[0m06:45:16.122394 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:54:15.806973 | 38334010-2393-4833-af68-fc3363c58793 ==============================
[0m06:54:15.806973 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:54:15.813002 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:54:15.817090 [debug] [MainThread]: Tracking: tracking
[0m06:54:15.834665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:54:15.847333 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:54:15.873315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:54:15.873765 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/films_rating_macros.sql
[0m06:54:15.874094 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films_rating.sql
[0m06:54:15.876188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f87be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e041f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e04280>]}
[0m06:54:15.876499 [debug] [MainThread]: Flushing usage events
[0m06:54:17.044436 [error] [MainThread]: Encountered an error:
Compilation Error
  expected token '(', got 'end of statement block'
    line 1
      {% macro generate_films_rating %}


============================== 2025-05-14 06:54:47.621864 | 80059879-fcd4-4816-9c9b-8c2c21ccac16 ==============================
[0m06:54:47.621864 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:54:47.625270 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:54:47.625509 [debug] [MainThread]: Tracking: tracking
[0m06:54:47.639623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:54:47.652608 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:54:47.677525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:54:47.677989 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/films_rating_macros.sql
[0m06:54:47.678297 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://models/example/films_rating.sql
[0m06:54:47.733438 [debug] [MainThread]: 1603: static parser failed on example/films_rating.sql
[0m06:54:47.745755 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/films_rating.sql
[0m06:54:47.755762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e800d0>]}
[0m06:54:47.763657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9debee0>]}
[0m06:54:47.764045 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 292 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m06:54:47.764417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72e1d0>]}
[0m06:54:47.765998 [info ] [MainThread]: 
[0m06:54:47.768061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:54:47.770338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m06:54:47.779674 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m06:54:47.780055 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m06:54:47.780290 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:54:47.830623 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m06:54:47.832283 [debug] [ThreadPool]: On list_destination_db: Close
[0m06:54:47.834956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m06:54:47.839645 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:54:47.839931 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m06:54:47.840172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:54:47.849615 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m06:54:47.849950 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m06:54:47.850183 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m06:54:47.851836 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m06:54:47.852975 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m06:54:47.853641 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m06:54:47.859086 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:47.859423 [debug] [MainThread]: On master: BEGIN
[0m06:54:47.859648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:54:47.868017 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:54:47.868336 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:47.868556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:54:47.871145 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m06:54:47.872144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723fa0>]}
[0m06:54:47.872533 [debug] [MainThread]: On master: ROLLBACK
[0m06:54:47.873165 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:47.873398 [debug] [MainThread]: On master: BEGIN
[0m06:54:47.874197 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:54:47.874447 [debug] [MainThread]: On master: COMMIT
[0m06:54:47.874672 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:47.874850 [debug] [MainThread]: On master: COMMIT
[0m06:54:47.875342 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:54:47.875574 [debug] [MainThread]: On master: Close
[0m06:54:47.876188 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:54:47.876493 [info ] [MainThread]: 
[0m06:54:47.889222 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m06:54:47.889760 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m06:54:47.890442 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m06:54:47.890754 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m06:54:47.892895 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m06:54:47.894173 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 06:54:47.890990 => 2025-05-14 06:54:47.894112
[0m06:54:47.894451 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m06:54:47.927835 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m06:54:47.929200 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:47.929499 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m06:54:47.929811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:47.940693 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:47.941226 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:47.941511 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m06:54:47.942997 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:54:47.949049 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:47.949321 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m06:54:47.949972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:47.952298 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:47.952583 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m06:54:47.953236 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:47.969706 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:54:47.970012 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:47.970216 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m06:54:47.971031 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:47.974802 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m06:54:47.975031 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m06:54:47.976547 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:47.977608 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 06:54:47.894650 => 2025-05-14 06:54:47.977559
[0m06:54:47.977812 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m06:54:47.978535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8cfa830>]}
[0m06:54:47.979438 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.09s]
[0m06:54:47.981132 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m06:54:47.981488 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m06:54:47.981798 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m06:54:47.982365 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m06:54:47.982610 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m06:54:47.985289 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m06:54:47.986009 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 06:54:47.982755 => 2025-05-14 06:54:47.985958
[0m06:54:47.986227 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m06:54:47.989086 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m06:54:47.989865 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:47.990027 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m06:54:47.990181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:47.998551 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:47.998843 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:47.999005 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m06:54:47.999951 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:54:48.002197 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:48.002419 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m06:54:48.002937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:48.004948 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:48.005145 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m06:54:48.005799 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:48.007235 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:54:48.007447 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:48.007652 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m06:54:48.008418 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:48.009898 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m06:54:48.010086 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m06:54:48.011270 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:48.012217 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 06:54:47.986365 => 2025-05-14 06:54:48.012170
[0m06:54:48.012423 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m06:54:48.013170 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d9b670>]}
[0m06:54:48.013612 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m06:54:48.014099 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m06:54:48.014393 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m06:54:48.014712 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m06:54:48.015247 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m06:54:48.015509 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m06:54:48.017674 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m06:54:48.018369 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 06:54:48.015663 => 2025-05-14 06:54:48.018324
[0m06:54:48.018674 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m06:54:48.021676 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m06:54:48.022245 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:48.022404 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m06:54:48.022630 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:48.031039 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:48.031372 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:48.031611 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m06:54:48.032730 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:54:48.034920 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:48.035132 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m06:54:48.035662 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:48.037567 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:48.037791 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m06:54:48.038408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:48.039958 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:54:48.040157 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:48.040325 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m06:54:48.041173 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:48.042732 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m06:54:48.042949 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m06:54:48.044373 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:48.046227 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 06:54:48.018829 => 2025-05-14 06:54:48.046167
[0m06:54:48.046485 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m06:54:48.047182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83d05e0>]}
[0m06:54:48.047620 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.03s]
[0m06:54:48.047994 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m06:54:48.049591 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m06:54:48.049854 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films_rating ............................... [RUN]
[0m06:54:48.050365 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m06:54:48.050598 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m06:54:48.052723 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m06:54:48.053508 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 06:54:48.050779 => 2025-05-14 06:54:48.053444
[0m06:54:48.053742 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m06:54:48.056678 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m06:54:48.057262 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:54:48.057437 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m06:54:48.057625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:54:48.065989 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m06:54:48.066303 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:54:48.066502 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    
WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        CASE 
            WHEN user_rating >= 4.5 THEN 'Excellent'
            WHEN user_rating >= 4.0 THEN 'Good'
            WHEN user_rating >= 3.0 THEN 'Average'
            ELSE 'Poor'
        END AS rating_category
    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m06:54:48.069243 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m06:54:48.071581 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:54:48.071785 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
alter table "destination_db"."public"."films_rating__dbt_tmp" rename to "films_rating"
[0m06:54:48.072347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m06:54:48.073706 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m06:54:48.073909 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:54:48.074062 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m06:54:48.074691 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m06:54:48.076183 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m06:54:48.076384 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
drop table if exists "destination_db"."public"."films_rating__dbt_backup" cascade
[0m06:54:48.076939 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m06:54:48.077943 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 06:54:48.053918 => 2025-05-14 06:54:48.077895
[0m06:54:48.078179 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m06:54:48.078873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80059879-fcd4-4816-9c9b-8c2c21ccac16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83bb370>]}
[0m06:54:48.079367 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films_rating .......................... [[32mSELECT 20[0m in 0.03s]
[0m06:54:48.079784 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m06:54:48.081077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:54:48.081364 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:48.081551 [debug] [MainThread]: On master: BEGIN
[0m06:54:48.081718 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:54:48.089851 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m06:54:48.090244 [debug] [MainThread]: On master: COMMIT
[0m06:54:48.090454 [debug] [MainThread]: Using postgres connection "master"
[0m06:54:48.090658 [debug] [MainThread]: On master: COMMIT
[0m06:54:48.091196 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m06:54:48.091423 [debug] [MainThread]: On master: Close
[0m06:54:48.091988 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:54:48.092205 [debug] [MainThread]: Connection 'model.custom_postgres.films_rating' was properly closed.
[0m06:54:48.092775 [info ] [MainThread]: 
[0m06:54:48.093173 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m06:54:48.093806 [debug] [MainThread]: Command end result
[0m06:54:48.098990 [info ] [MainThread]: 
[0m06:54:48.099421 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:54:48.099781 [info ] [MainThread]: 
[0m06:54:48.100095 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m06:54:48.100488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9debbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83ba290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8cfb580>]}
[0m06:54:48.100741 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 06:59:59.238434 | 5f6802ab-06ad-45d0-b816-d8f28affd24b ==============================
[0m06:59:59.238434 [info ] [MainThread]: Running with dbt=1.4.7
[0m06:59:59.243958 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m06:59:59.244880 [debug] [MainThread]: Tracking: tracking
[0m06:59:59.260530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m06:59:59.272694 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m06:59:59.300922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m06:59:59.303025 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/rating_category_macro.sql
[0m06:59:59.305112 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/films_rating_macros.sql
[0m06:59:59.364507 [debug] [MainThread]: 1603: static parser failed on example/films_rating.sql
[0m06:59:59.369362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f87d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e47f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e606a0>]}
[0m06:59:59.369794 [debug] [MainThread]: Flushing usage events
[0m07:00:00.618642 [error] [MainThread]: Encountered an error:
Compilation Error in model films_rating (models/example/films_rating.sql)
  'films_category' is undefined


============================== 2025-05-14 07:00:44.341739 | ccfe0ce8-3978-4dc8-9709-4d6d620d250b ==============================
[0m07:00:44.341739 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:00:44.345467 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:00:44.347482 [debug] [MainThread]: Tracking: tracking
[0m07:00:44.362878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7250f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7257b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb725390>]}
[0m07:00:44.378629 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:00:44.407299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m07:00:44.407809 [debug] [MainThread]: Partial parsing: added file: custom_postgres://macros/rating_category_macro.sql
[0m07:00:44.408254 [debug] [MainThread]: Partial parsing: updated file: custom_postgres://macros/films_rating_macros.sql
[0m07:00:44.469382 [debug] [MainThread]: 1603: static parser failed on example/films_rating.sql
[0m07:00:44.483271 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/films_rating.sql
[0m07:00:44.492519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e90310>]}
[0m07:00:44.500512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f87970>]}
[0m07:00:44.501009 [info ] [MainThread]: Found 4 models, 0 tests, 0 snapshots, 0 analyses, 293 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:00:44.501509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72c580>]}
[0m07:00:44.503329 [info ] [MainThread]: 
[0m07:00:44.505777 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:44.508957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:00:44.518550 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:00:44.519020 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:00:44.519305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:44.568899 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:00:44.570568 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:00:44.573299 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:00:44.578202 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:00:44.578485 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:00:44.578771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:00:44.588575 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:00:44.588939 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:00:44.589151 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:00:44.590846 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:00:44.591944 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:00:44.592574 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:00:44.598077 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:44.598481 [debug] [MainThread]: On master: BEGIN
[0m07:00:44.598697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:00:44.607232 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:00:44.607606 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:44.607827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:00:44.610297 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:00:44.611270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb72c4f0>]}
[0m07:00:44.611714 [debug] [MainThread]: On master: ROLLBACK
[0m07:00:44.612301 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:44.612520 [debug] [MainThread]: On master: BEGIN
[0m07:00:44.613449 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:00:44.613978 [debug] [MainThread]: On master: COMMIT
[0m07:00:44.614228 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:44.614427 [debug] [MainThread]: On master: COMMIT
[0m07:00:44.615036 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:00:44.615302 [debug] [MainThread]: On master: Close
[0m07:00:44.616071 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:00:44.616467 [info ] [MainThread]: 
[0m07:00:44.634313 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:00:44.634973 [info ] [Thread-1 (]: 1 of 4 START sql table model public.actors ..................................... [RUN]
[0m07:00:44.636276 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:00:44.636736 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:00:44.639281 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:00:44.640353 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 07:00:44.636964 => 2025-05-14 07:00:44.640268
[0m07:00:44.640606 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:00:44.671850 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:00:44.673049 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:00:44.673276 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:00:44.673474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:44.682009 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:00:44.682368 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:00:44.682580 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:00:44.683657 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:00:44.688942 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:00:44.689220 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:00:44.689987 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:00:44.692115 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:00:44.692367 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:00:44.692990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:00:44.709481 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:00:44.709874 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:00:44.710081 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:00:44.711160 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:00:44.715641 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:00:44.715882 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:00:44.717623 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:00:44.718657 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 07:00:44.640772 => 2025-05-14 07:00:44.718609
[0m07:00:44.718898 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:00:44.719629 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d406a0>]}
[0m07:00:44.720570 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.08s]
[0m07:00:44.722095 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:00:44.722458 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:00:44.722772 [info ] [Thread-1 (]: 2 of 4 START sql table model public.film_actors ................................ [RUN]
[0m07:00:44.723310 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:00:44.723547 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:00:44.725631 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:00:44.726301 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 07:00:44.723692 => 2025-05-14 07:00:44.726256
[0m07:00:44.726511 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:00:44.729489 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:00:44.730046 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:00:44.730225 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:00:44.730412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:44.738898 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:00:44.739230 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:00:44.739432 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:00:44.740411 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:00:44.742637 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:00:44.742837 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:00:44.743359 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:00:44.745204 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:00:44.745425 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:00:44.746064 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:00:44.747636 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:00:44.747845 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:00:44.748016 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:00:44.748825 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:00:44.750332 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:00:44.750543 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:00:44.751973 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:00:44.752986 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 07:00:44.726641 => 2025-05-14 07:00:44.752940
[0m07:00:44.753210 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:00:44.753940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff8d41390>]}
[0m07:00:44.754355 [info ] [Thread-1 (]: 2 of 4 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.03s]
[0m07:00:44.754974 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:00:44.755301 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:00:44.755677 [info ] [Thread-1 (]: 3 of 4 START sql table model public.films ...................................... [RUN]
[0m07:00:44.756248 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:00:44.756524 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:00:44.758932 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:00:44.759868 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 07:00:44.756726 => 2025-05-14 07:00:44.759803
[0m07:00:44.760121 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:00:44.763849 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:00:44.764701 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:00:44.764896 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:00:44.765064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:44.774869 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:00:44.775270 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:00:44.775480 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:00:44.776775 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:00:44.779218 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:00:44.779569 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:00:44.780407 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:00:44.783709 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:00:44.784078 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:00:44.785023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:00:44.787189 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:00:44.787689 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:00:44.788057 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:00:44.789236 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:00:44.791149 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:00:44.791488 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:00:44.793510 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:00:44.794769 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 07:00:44.760266 => 2025-05-14 07:00:44.794710
[0m07:00:44.795023 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:00:44.795834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83c3f40>]}
[0m07:00:44.796406 [info ] [Thread-1 (]: 3 of 4 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m07:00:44.796922 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:00:44.798641 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m07:00:44.798948 [info ] [Thread-1 (]: 4 of 4 START sql table model public.films_rating ............................... [RUN]
[0m07:00:44.799543 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m07:00:44.799797 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m07:00:44.802349 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m07:00:44.803282 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 07:00:44.799964 => 2025-05-14 07:00:44.803214
[0m07:00:44.803631 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m07:00:44.806961 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m07:00:44.807756 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:00:44.807972 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m07:00:44.808157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:00:44.817277 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:00:44.817737 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:00:44.818008 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    
WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        
CASE 
        WHEN user_rating >= 4.5 THEN 'Excellent'
        WHEN user_rating >= 4.0 THEN 'Good'
        WHEN user_rating >= 3.0 THEN 'Average'
        ELSE 'Poor'
    END AS rating_category

    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m07:00:44.821039 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:00:44.823390 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:00:44.823648 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
alter table "destination_db"."public"."films_rating__dbt_tmp" rename to "films_rating"
[0m07:00:44.824331 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:00:44.825756 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m07:00:44.825950 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:00:44.826100 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m07:00:44.826930 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:00:44.828608 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:00:44.828827 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
drop table if exists "destination_db"."public"."films_rating__dbt_backup" cascade
[0m07:00:44.829406 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:00:44.830511 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 07:00:44.803810 => 2025-05-14 07:00:44.830464
[0m07:00:44.830719 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m07:00:44.831439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccfe0ce8-3978-4dc8-9709-4d6d620d250b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff839e9e0>]}
[0m07:00:44.831870 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.films_rating .......................... [[32mSELECT 20[0m in 0.03s]
[0m07:00:44.832362 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m07:00:44.833757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:00:44.834008 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:44.834206 [debug] [MainThread]: On master: BEGIN
[0m07:00:44.834375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:00:44.843977 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:00:44.844385 [debug] [MainThread]: On master: COMMIT
[0m07:00:44.844642 [debug] [MainThread]: Using postgres connection "master"
[0m07:00:44.844874 [debug] [MainThread]: On master: COMMIT
[0m07:00:44.845437 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:00:44.845724 [debug] [MainThread]: On master: Close
[0m07:00:44.846376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:44.846628 [debug] [MainThread]: Connection 'model.custom_postgres.films_rating' was properly closed.
[0m07:00:44.847290 [info ] [MainThread]: 
[0m07:00:44.847690 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m07:00:44.848278 [debug] [MainThread]: Command end result
[0m07:00:44.854212 [info ] [MainThread]: 
[0m07:00:44.854651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:00:44.855038 [info ] [MainThread]: 
[0m07:00:44.855341 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m07:00:44.855783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f87850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83c3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e438e0>]}
[0m07:00:44.856081 [debug] [MainThread]: Flushing usage events


============================== 2025-05-14 07:05:10.494801 | d03c3e65-2d00-437f-833c-629a4633e278 ==============================
[0m07:05:10.494801 [info ] [MainThread]: Running with dbt=1.4.7
[0m07:05:10.501297 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/root', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'project_dir': '/dbt', 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m07:05:10.501678 [debug] [MainThread]: Tracking: tracking
[0m07:05:10.521043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7210f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb7217b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb721390>]}
[0m07:05:10.538216 [debug] [MainThread]: checksum: f4f4cdde9b257b3a8e3791263c44f34b0bd0facc33ef1ba84a563bd63785ce73, vars: {}, profile: None, target: None, version: 1.4.7
[0m07:05:10.577567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m07:05:10.578513 [debug] [MainThread]: Partial parsing: added file: custom_postgres://models/example/specific_film.sql
[0m07:05:10.610434 [debug] [MainThread]: 1603: static parser failed on example/specific_film.sql
[0m07:05:10.648790 [debug] [MainThread]: 1602: parser fallback to jinja rendering on example/specific_film.sql
[0m07:05:10.686527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9e840d0>]}
[0m07:05:10.701508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f87e80>]}
[0m07:05:10.701914 [info ] [MainThread]: Found 5 models, 0 tests, 0 snapshots, 0 analyses, 293 macros, 0 operations, 0 seed files, 3 sources, 0 exposures, 0 metrics
[0m07:05:10.702216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9f87f10>]}
[0m07:05:10.703853 [info ] [MainThread]: 
[0m07:05:10.705857 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:05:10.708430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db'
[0m07:05:10.718620 [debug] [ThreadPool]: Using postgres connection "list_destination_db"
[0m07:05:10.719028 [debug] [ThreadPool]: On list_destination_db: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db"} */

    select distinct nspname from pg_namespace
  
[0m07:05:10.719308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:05:10.770718 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m07:05:10.772610 [debug] [ThreadPool]: On list_destination_db: Close
[0m07:05:10.775411 [debug] [ThreadPool]: Acquiring new postgres connection 'list_destination_db_public'
[0m07:05:10.780631 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:05:10.781033 [debug] [ThreadPool]: On list_destination_db_public: BEGIN
[0m07:05:10.781272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:05:10.792229 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m07:05:10.792751 [debug] [ThreadPool]: Using postgres connection "list_destination_db_public"
[0m07:05:10.793047 [debug] [ThreadPool]: On list_destination_db_public: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "list_destination_db_public"} */
select
      'destination_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'destination_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m07:05:10.795277 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m07:05:10.796499 [debug] [ThreadPool]: On list_destination_db_public: ROLLBACK
[0m07:05:10.797187 [debug] [ThreadPool]: On list_destination_db_public: Close
[0m07:05:10.802846 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:10.803265 [debug] [MainThread]: On master: BEGIN
[0m07:05:10.803498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:05:10.813972 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:05:10.814385 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:10.814644 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:05:10.817614 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m07:05:10.818741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffffb723a30>]}
[0m07:05:10.819142 [debug] [MainThread]: On master: ROLLBACK
[0m07:05:10.819721 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:10.819977 [debug] [MainThread]: On master: BEGIN
[0m07:05:10.820847 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:05:10.821138 [debug] [MainThread]: On master: COMMIT
[0m07:05:10.821360 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:10.821554 [debug] [MainThread]: On master: COMMIT
[0m07:05:10.822180 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:05:10.822430 [debug] [MainThread]: On master: Close
[0m07:05:10.823076 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:05:10.823394 [info ] [MainThread]: 
[0m07:05:10.837089 [debug] [Thread-1 (]: Began running node model.custom_postgres.actors
[0m07:05:10.837682 [info ] [Thread-1 (]: 1 of 5 START sql table model public.actors ..................................... [RUN]
[0m07:05:10.838502 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.actors'
[0m07:05:10.838806 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.actors
[0m07:05:10.841079 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.actors"
[0m07:05:10.842267 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (compile): 2025-05-14 07:05:10.839032 => 2025-05-14 07:05:10.842180
[0m07:05:10.842556 [debug] [Thread-1 (]: Began executing node model.custom_postgres.actors
[0m07:05:10.875406 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.actors"
[0m07:05:10.876862 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:05:10.877258 [debug] [Thread-1 (]: On model.custom_postgres.actors: BEGIN
[0m07:05:10.877506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:10.886719 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:05:10.887167 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:05:10.887452 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */

  
    

  create  table "destination_db"."public"."actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."actors"
  );
  
[0m07:05:10.888983 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:05:10.894809 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:05:10.895245 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors" rename to "actors__dbt_backup"
[0m07:05:10.896222 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:10.898579 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:05:10.898846 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
alter table "destination_db"."public"."actors__dbt_tmp" rename to "actors"
[0m07:05:10.899614 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:10.917299 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:05:10.917723 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:05:10.917931 [debug] [Thread-1 (]: On model.custom_postgres.actors: COMMIT
[0m07:05:10.919038 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:05:10.923248 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.actors"
[0m07:05:10.923525 [debug] [Thread-1 (]: On model.custom_postgres.actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.actors"} */
drop table if exists "destination_db"."public"."actors__dbt_backup" cascade
[0m07:05:10.925637 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:05:10.927133 [debug] [Thread-1 (]: Timing info for model.custom_postgres.actors (execute): 2025-05-14 07:05:10.842736 => 2025-05-14 07:05:10.927070
[0m07:05:10.927471 [debug] [Thread-1 (]: On model.custom_postgres.actors: Close
[0m07:05:10.928310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d052d0>]}
[0m07:05:10.929312 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.actors ................................ [[32mSELECT 20[0m in 0.09s]
[0m07:05:10.931100 [debug] [Thread-1 (]: Finished running node model.custom_postgres.actors
[0m07:05:10.931455 [debug] [Thread-1 (]: Began running node model.custom_postgres.film_actors
[0m07:05:10.931791 [info ] [Thread-1 (]: 2 of 5 START sql table model public.film_actors ................................ [RUN]
[0m07:05:10.932395 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.film_actors'
[0m07:05:10.932628 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.film_actors
[0m07:05:10.935568 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.film_actors"
[0m07:05:10.936402 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (compile): 2025-05-14 07:05:10.932773 => 2025-05-14 07:05:10.936344
[0m07:05:10.936615 [debug] [Thread-1 (]: Began executing node model.custom_postgres.film_actors
[0m07:05:10.939692 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.film_actors"
[0m07:05:10.940277 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:05:10.940440 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: BEGIN
[0m07:05:10.940586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:10.950931 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:05:10.951385 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:05:10.951586 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */

  
    

  create  table "destination_db"."public"."film_actors__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."film_actors"
  );
  
[0m07:05:10.952590 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:05:10.954854 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:05:10.955121 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors" rename to "film_actors__dbt_backup"
[0m07:05:10.955913 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:10.957946 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:05:10.958337 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
alter table "destination_db"."public"."film_actors__dbt_tmp" rename to "film_actors"
[0m07:05:10.959140 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:10.961035 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:05:10.961402 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:05:10.961616 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: COMMIT
[0m07:05:10.962740 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:05:10.964506 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.film_actors"
[0m07:05:10.964728 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.film_actors"} */
drop table if exists "destination_db"."public"."film_actors__dbt_backup" cascade
[0m07:05:10.966045 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:05:10.967133 [debug] [Thread-1 (]: Timing info for model.custom_postgres.film_actors (execute): 2025-05-14 07:05:10.936752 => 2025-05-14 07:05:10.967083
[0m07:05:10.967366 [debug] [Thread-1 (]: On model.custom_postgres.film_actors: Close
[0m07:05:10.968143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff9d9a230>]}
[0m07:05:10.968546 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.film_actors ........................... [[32mSELECT 20[0m in 0.04s]
[0m07:05:10.969163 [debug] [Thread-1 (]: Finished running node model.custom_postgres.film_actors
[0m07:05:10.969444 [debug] [Thread-1 (]: Began running node model.custom_postgres.films
[0m07:05:10.969735 [info ] [Thread-1 (]: 3 of 5 START sql table model public.films ...................................... [RUN]
[0m07:05:10.970277 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films'
[0m07:05:10.970491 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films
[0m07:05:10.972748 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films"
[0m07:05:10.973475 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (compile): 2025-05-14 07:05:10.970631 => 2025-05-14 07:05:10.973426
[0m07:05:10.973686 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films
[0m07:05:10.976750 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films"
[0m07:05:10.977388 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:05:10.977566 [debug] [Thread-1 (]: On model.custom_postgres.films: BEGIN
[0m07:05:10.977720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:10.986139 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:05:10.986468 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:05:10.986632 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */

  
    

  create  table "destination_db"."public"."films__dbt_tmp"
  as (
    SELECT * FROM "destination_db"."public"."films"
  );
  
[0m07:05:10.987696 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:05:10.990271 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:05:10.990580 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films" rename to "films__dbt_backup"
[0m07:05:10.991297 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:10.993976 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:05:10.994223 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
alter table "destination_db"."public"."films__dbt_tmp" rename to "films"
[0m07:05:10.994850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:10.996969 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:05:10.997196 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:05:10.997354 [debug] [Thread-1 (]: On model.custom_postgres.films: COMMIT
[0m07:05:10.998591 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:05:11.000941 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films"
[0m07:05:11.001236 [debug] [Thread-1 (]: On model.custom_postgres.films: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films"} */
drop table if exists "destination_db"."public"."films__dbt_backup" cascade
[0m07:05:11.002872 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:05:11.005347 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films (execute): 2025-05-14 07:05:10.973837 => 2025-05-14 07:05:11.005287
[0m07:05:11.005597 [debug] [Thread-1 (]: On model.custom_postgres.films: Close
[0m07:05:11.006463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83cd150>]}
[0m07:05:11.006953 [info ] [Thread-1 (]: 3 of 5 OK created sql table model public.films ................................. [[32mSELECT 20[0m in 0.04s]
[0m07:05:11.007537 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films
[0m07:05:11.009130 [debug] [Thread-1 (]: Began running node model.custom_postgres.films_rating
[0m07:05:11.009536 [info ] [Thread-1 (]: 4 of 5 START sql table model public.films_rating ............................... [RUN]
[0m07:05:11.010286 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.films_rating'
[0m07:05:11.010506 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.films_rating
[0m07:05:11.015876 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.films_rating"
[0m07:05:11.016741 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (compile): 2025-05-14 07:05:11.010660 => 2025-05-14 07:05:11.016660
[0m07:05:11.017049 [debug] [Thread-1 (]: Began executing node model.custom_postgres.films_rating
[0m07:05:11.021032 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.films_rating"
[0m07:05:11.021751 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:05:11.021995 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: BEGIN
[0m07:05:11.022222 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:11.031003 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:05:11.031393 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:05:11.031604 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */

  
    

  create  table "destination_db"."public"."films_rating__dbt_tmp"
  as (
    
WITH films_with_ratings AS (
    SELECT
        film_id,
        title,
        release_date,
        price,
        rating,
        user_rating,
        
CASE 
        WHEN user_rating >= 4.5 THEN 'Excellent'
        WHEN user_rating >= 4.0 THEN 'Good'
        WHEN user_rating >= 3.0 THEN 'Average'
        ELSE 'Poor'
    END AS rating_category

    FROM "destination_db"."public"."films"
),
films_with_actors AS (
    SELECT
        f.film_id,
        f.title,
        STRING_AGG(a.actor_name, ', ') AS actors  -- Aggregating actor names for each film
    FROM "destination_db"."public"."films" f
    LEFT JOIN "destination_db"."public"."film_actors" fa ON f.film_id = fa.film_id
    LEFT JOIN "destination_db"."public"."actors" a ON fa.actor_id = a.actor_id
    GROUP BY f.film_id, f.title
)

SELECT
    fwf.*,
    fwa.actors
FROM films_with_ratings fwf
LEFT JOIN films_with_actors fwa ON fwf.film_id = fwa.film_id


  );
  
[0m07:05:11.034227 [debug] [Thread-1 (]: SQL status: SELECT 20 in 0 seconds
[0m07:05:11.036599 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:05:11.036819 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
alter table "destination_db"."public"."films_rating__dbt_tmp" rename to "films_rating"
[0m07:05:11.037385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:11.038752 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m07:05:11.039010 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:05:11.039178 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: COMMIT
[0m07:05:11.039839 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:05:11.041390 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.films_rating"
[0m07:05:11.041576 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.films_rating"} */
drop table if exists "destination_db"."public"."films_rating__dbt_backup" cascade
[0m07:05:11.042146 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:05:11.043145 [debug] [Thread-1 (]: Timing info for model.custom_postgres.films_rating (execute): 2025-05-14 07:05:11.017244 => 2025-05-14 07:05:11.043093
[0m07:05:11.043351 [debug] [Thread-1 (]: On model.custom_postgres.films_rating: Close
[0m07:05:11.044067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83cdd20>]}
[0m07:05:11.044502 [info ] [Thread-1 (]: 4 of 5 OK created sql table model public.films_rating .......................... [[32mSELECT 20[0m in 0.03s]
[0m07:05:11.044977 [debug] [Thread-1 (]: Finished running node model.custom_postgres.films_rating
[0m07:05:11.045303 [debug] [Thread-1 (]: Began running node model.custom_postgres.specific_film
[0m07:05:11.045619 [info ] [Thread-1 (]: 5 of 5 START sql table model public.specific_film .............................. [RUN]
[0m07:05:11.046217 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.custom_postgres.specific_film'
[0m07:05:11.046469 [debug] [Thread-1 (]: Began compiling node model.custom_postgres.specific_film
[0m07:05:11.048770 [debug] [Thread-1 (]: Writing injected SQL for node "model.custom_postgres.specific_film"
[0m07:05:11.049479 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_film (compile): 2025-05-14 07:05:11.046630 => 2025-05-14 07:05:11.049430
[0m07:05:11.049680 [debug] [Thread-1 (]: Began executing node model.custom_postgres.specific_film
[0m07:05:11.052940 [debug] [Thread-1 (]: Writing runtime sql for node "model.custom_postgres.specific_film"
[0m07:05:11.053599 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_film"
[0m07:05:11.053763 [debug] [Thread-1 (]: On model.custom_postgres.specific_film: BEGIN
[0m07:05:11.053913 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:05:11.062973 [debug] [Thread-1 (]: SQL status: BEGIN in 0 seconds
[0m07:05:11.063341 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_film"
[0m07:05:11.063512 [debug] [Thread-1 (]: On model.custom_postgres.specific_film: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_film"} */

  
    

  create  table "destination_db"."public"."specific_film__dbt_tmp"
  as (
    
SELECT *
FROM "destination_db"."public"."films"
where title = 'Jurassic Park'
  );
  
[0m07:05:11.064746 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0 seconds
[0m07:05:11.066959 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_film"
[0m07:05:11.067166 [debug] [Thread-1 (]: On model.custom_postgres.specific_film: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_film"} */
alter table "destination_db"."public"."specific_film__dbt_tmp" rename to "specific_film"
[0m07:05:11.067761 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0 seconds
[0m07:05:11.069129 [debug] [Thread-1 (]: On model.custom_postgres.specific_film: COMMIT
[0m07:05:11.069354 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_film"
[0m07:05:11.069613 [debug] [Thread-1 (]: On model.custom_postgres.specific_film: COMMIT
[0m07:05:11.070490 [debug] [Thread-1 (]: SQL status: COMMIT in 0 seconds
[0m07:05:11.072188 [debug] [Thread-1 (]: Using postgres connection "model.custom_postgres.specific_film"
[0m07:05:11.072385 [debug] [Thread-1 (]: On model.custom_postgres.specific_film: /* {"app": "dbt", "dbt_version": "1.4.7", "profile_name": "custom_postgres", "target_name": "dev", "node_id": "model.custom_postgres.specific_film"} */
drop table if exists "destination_db"."public"."specific_film__dbt_backup" cascade
[0m07:05:11.072909 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0 seconds
[0m07:05:11.073874 [debug] [Thread-1 (]: Timing info for model.custom_postgres.specific_film (execute): 2025-05-14 07:05:11.049812 => 2025-05-14 07:05:11.073827
[0m07:05:11.074100 [debug] [Thread-1 (]: On model.custom_postgres.specific_film: Close
[0m07:05:11.074746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd03c3e65-2d00-437f-833c-629a4633e278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83cc7c0>]}
[0m07:05:11.075166 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.specific_film ......................... [[32mSELECT 1[0m in 0.03s]
[0m07:05:11.075530 [debug] [Thread-1 (]: Finished running node model.custom_postgres.specific_film
[0m07:05:11.076868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:05:11.077153 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:11.077526 [debug] [MainThread]: On master: BEGIN
[0m07:05:11.077744 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:05:11.086882 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m07:05:11.087271 [debug] [MainThread]: On master: COMMIT
[0m07:05:11.087461 [debug] [MainThread]: Using postgres connection "master"
[0m07:05:11.087625 [debug] [MainThread]: On master: COMMIT
[0m07:05:11.088047 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m07:05:11.088302 [debug] [MainThread]: On master: Close
[0m07:05:11.088960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:05:11.089187 [debug] [MainThread]: Connection 'model.custom_postgres.specific_film' was properly closed.
[0m07:05:11.089696 [info ] [MainThread]: 
[0m07:05:11.090132 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.39 seconds (0.39s).
[0m07:05:11.090619 [debug] [MainThread]: Command end result
[0m07:05:11.096831 [info ] [MainThread]: 
[0m07:05:11.097225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:05:11.097552 [info ] [MainThread]: 
[0m07:05:11.097856 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m07:05:11.098240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e38e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e3100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffff83e3b20>]}
[0m07:05:11.098502 [debug] [MainThread]: Flushing usage events
